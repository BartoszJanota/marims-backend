<html>
    <head>
        <script src='socket.io/socket.io.js'></script>
        <script>
            var refresh = function(image, screenWidth, screenHeight) {
                if(image !== null && image !== undefined) {
                    var screen = document.getElementById('screen');
                    screen.addEventListener('click', function(event, pos){
                        if(event.pageX != 0 && event.pageY != 0) {
                            //Math.floor(event.offsetX/screen.width*data.width)
                            //Math.floor(event.offsetY/screen.height*data.height)
                        }
                    });
                    screen.src = 'data:image/jpg;base64,' + image;
                }
            };

            console.log('Connecting to websocket at url ' + 'http://' + location.host + '/browser' + location.pathname);

            var socket = io.connect('http://' + location.host + '/browser' + location.pathname);

            socket.on('refresh', function(data){
                console.log('Refreshing');
                if(data !== null && data !== undefined){
                    refresh(data.image, data.screenWidth, data.screenHeight);
                }
            });

            socket.on('debug', function(data){
                console.log(data);
            });

            socket.on('start', function(data){
                console.log('Starting: ' + data);
            });
        </script>
    </head>

    <body>
        <img id="screen" src="/image" style="height:90%"/>
    </body>
</html>